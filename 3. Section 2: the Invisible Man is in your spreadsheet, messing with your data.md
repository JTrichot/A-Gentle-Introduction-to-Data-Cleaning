Introduction

Il y a quelque chose d'effrayant dans votre feuille de calcul, et ce n'est pas sympathique.

http://farm9.staticflickr.com/8092/8402327514_10a8f622fd_n_d.jpg
Illustration 1: Le poster du film de l'Homme invisible, 1933. Source de l'image. Reproduit sous licence "Fair Use".

“Même la Lune est effrayée par moi”, hurle l'Homme invisible, autrement connu sous le nom de Dr Griffen, un génie rendu fou après avoir expérimenté sur lui-même! Si vous avez le temps, regardez la bande-annonce du film de 1933. Des choses effrayantes commencent à arriver aux gens dans une petite ville: des traces de pas dans la neige mystérieuses, des objets de maison qui semblent voler dans les airs, des gens qui sont poussés dans les escaliers (et depuis les collines!). Et dans notre cas: [messing with our spreadsheet].

Nous ne pouvons pas voir l'Homme invisible lui-même (évidemment, ou il ne serait pas invisible). Mais nous n'arrivons pas à trouver des traces de ce travail dans notre feuille de calcul, alors que nous pouvons voir ses empreintes de pas dans la neige :

http://farm9.staticflickr.com/8086/8402327534_fb1e33e0a7_o_d.png

Une erreur qu'il a inséré que vous pouvez voir clairement, mais que les autres sont plus difficiles à identifier à l'oeil nu:

- Des espaces en trop à la fin des entrées.
- Des tabulations sont insérées à la fin des lignes
- Des retours à la ligne et des ‘retours chariots’, que vous insérez en appuyant sur Entrée (ou Ctrl-Entrée).

Ces élements sont appelés des caractères “non-imprimables”, et ne sont pas affichés tout le temps dans les feuilles de calcul. Mais vous sentirez toujours leur sinistre présence comme iles affectent beaucoup l'anlayse des données. C'est parce que les feuilles de calcul traitent ces types de caractères comme des vrais données. En ignorant la colonne d'étiquette, dans les données ci-dessus, vous pouvez voir quatre termes qui sont essentiellement les mêmes. La feuille de calcul, cependant, voit quatre différents et distinct morceaux de données. Si vous essayiez de compter le nombre de fois que “Your Data” est mentionné, une feuille de calcul vous montrerait seulement une seule entrée.

Dans le film, la police déploye un piège pour attraper l'Homme invisible. Nous pouvons faire la même chose dans nos feuilles de calcul. A la fin de la section, vous devriez avoir:

- quelques connaissances sur les caractères non imprimables qui causent des erreurs dans les données
- essayé différentes fonctions et caractéristiques de votre tableur qui peuvent les enlever

Un peu de travail supplémentaire

Pour faire les tâches à la fois rapides et plus longues ci-dessous, vous aurez besoin de :

1. un outil de manipulation des feuilles de calcul, comme Excel ou Libre Office.
2. une copie de la feuille de calcul exemple pour cette section.
3. une copie du jeu de données du cours, qui est la donnée de GRAIN (http://grain.org) sur “l'accaparement des terres”.

Une tâche rapide (15 minutes)

- Télécharger et ouvrir la feuile de calcul exemple sur votre ordinateur. Dans la colonne A, on trouve la donnée provenant d'au dessus, avec différent types de caractères non-imprimables. Dans les colonnes B-E sont les quatres méthodes simples pour enlever les caractères non-imprimables de votre donnée: * la fonction TRIM (dans la colonne B) * la fonction CLEAN (dans la colonne C) * les fonctions TRIM et CLEAN …. ensemble! (dans la colonne D) * la fonction “Collage spécial” (dans la colonne E)
- Appliquer un “AutoFiltre” sur la donnée (Données → Filtre → AutoFiltre). Cliquez sur les petites flèches descendantes et une liste de sélection va apparaître en se déroulant, affichant le nombre d'entrées distinctes dans chaque colonnes. Si vous cliquez sur l'autofiltre pour chacunes des colonnes A jusqu'à E, vous pouvez voir l'effet des différentes méthodes pour enlever les caractères non-imprimables.
- Double-cliquez sur les cellules pour voir les formules et comment les fonctions marchent en pratique. Il y a plus d'informations sur chacune d'elles dans la partie ‘Etudes’ ci-dessous.
- Maintenant, essayez par vous-même. Créez ou trouvez un colonne de donnée unique par vous-même. Appliquez ces quatre méthodes dans le même format que notre jeu de données dans votre feuille de calcul.
Utilisez la zone de discussion ci-dessous pour partager votre travail et de nombreuses observations sur cette tâche.

Une tâche plus longue (30-60 minutes)

From the Data Wrangling Handbook Recipe on Data Cleaning, run through Problem 2: Whitespace and new lines – data that shouldn’t be there using the GRAIN dataset. This goes into more detail about the CLEAN and TRIM functions.

Reading list

- Watch this useful YouTube video from Excel is Fun about using CLEAN and TRIM.
- Read Microsoft’s surprisingly helpful help page on removing extra spaces and non-printable characters, here. Much of this will work in LibreOffice and Google Spreadsheets, though there are differences. Cast your eye over the Function documentation: TRIM (Excel, LibreOffice, Google Docs) and CLEAN (Excel, LibreOffice, Google Docs).
- Read the Feature documentation: Paste Special (Excel, LibreOffice, Google Docs), Autofilter (Excel, LibreOffice, Google Docs)
- For advanced Invisible Man hunters you can read up about using regular expressions in LibreOffice, here. We also cover this in the longer task above, but it’s not straightforward.

Rest and reflect

The Invisible Man can appear at any time, so we must be vigilant.

- How does white space get into your data?
- Can you think of other ways to approach the problem?

Post your thoughts in the discussion area.

Then get moving to the third section in this course on data cleaning, called “Your data is a witch’s brew”.

- See more at: http://schoolofdata.org/handbook/courses/data-cleaning-invisible-man-in-spreadsheets/#sthash.oUzMGTUl.dpuf
